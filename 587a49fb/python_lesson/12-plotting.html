<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>CDABS Intro to Programming - Producing Plots</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">CDABS Intro to Programming</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-shell" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Shell</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-shell">    
        <li>
    <a class="dropdown-item" href="../shell_lesson/01-introduction.html">
 <span class="dropdown-text">Introducing the Shell</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../shell_lesson/02-the-filesystem.html">
 <span class="dropdown-text">Navigating Files and Directories</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../shell_lesson/06-organization.html">
 <span class="dropdown-text">Project Organization</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../shell_lesson/04-redirection.html">
 <span class="dropdown-text">Redirection</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../shell_lesson/03-working-with-files.html">
 <span class="dropdown-text">Working with Files and Directories</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../shell_lesson/05-writing-scripts.html">
 <span class="dropdown-text">Writing Scripts and Working with Data</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-r" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">R</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-r">    
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-python" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Python</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-python">    
        <li>
    <a class="dropdown-item" href="../python_lesson/13-files.html">
 <span class="dropdown-text">Analyzing Data from Multiple Files</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../python_lesson/16-cmdline.html">
 <span class="dropdown-text">Command-Line Programs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../python_lesson/09-func.html">
 <span class="dropdown-text">Creating Functions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../python_lesson/10-errors.html">
 <span class="dropdown-text">Errors and Exceptions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../python_lesson/14-filtering.html">
 <span class="dropdown-text">Filtering Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../python_lesson/17-conda.html">
 <span class="dropdown-text">Installing Bioinformatics Packages</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../python_lesson/01-intro.html">
 <span class="dropdown-text">Introduction to Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../python_lesson/06-conditionals.html">
 <span class="dropdown-text">Making Choices</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../python_lesson/03-operators.html">
 <span class="dropdown-text">Operators</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../python_lesson/12-plotting.html">
 <span class="dropdown-text">Producing Plots</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../python_lesson/11-loaddata.html">
 <span class="dropdown-text">Reading in Tabular Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../python_lesson/07-loop.html">
 <span class="dropdown-text">Repeating Actions with Loops</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../python_lesson/04-collections.html">
 <span class="dropdown-text">Storing Multiple Values in Collections</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../python_lesson/15-tidying.html">
 <span class="dropdown-text">Tidying up the Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../python_lesson/02-variables.html">
 <span class="dropdown-text">Types, Objects, Values and Variables</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../python_lesson/08-libraries.html">
 <span class="dropdown-text">Using External Modules</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../python_lesson/05-scripts.html">
 <span class="dropdown-text">Writing Python Scripts</span></a>
  </li>  
    </ul>
  </li>
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Producing Plots</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_lesson/13-files.html" class="sidebar-item-text sidebar-link">Analyzing Data from Multiple Files</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_lesson/16-cmdline.html" class="sidebar-item-text sidebar-link">Command-Line Programs</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_lesson/09-func.html" class="sidebar-item-text sidebar-link">Creating Functions</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_lesson/10-errors.html" class="sidebar-item-text sidebar-link">Errors and Exceptions</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_lesson/14-filtering.html" class="sidebar-item-text sidebar-link">Filtering Data</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_lesson/17-conda.html" class="sidebar-item-text sidebar-link">Installing Bioinformatics Packages</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_lesson/01-intro.html" class="sidebar-item-text sidebar-link">Introduction to Python</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_lesson/06-conditionals.html" class="sidebar-item-text sidebar-link">Making Choices</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_lesson/03-operators.html" class="sidebar-item-text sidebar-link">Operators</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_lesson/12-plotting.html" class="sidebar-item-text sidebar-link active">Producing Plots</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_lesson/11-loaddata.html" class="sidebar-item-text sidebar-link">Reading in Tabular Data</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_lesson/07-loop.html" class="sidebar-item-text sidebar-link">Repeating Actions with Loops</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_lesson/04-collections.html" class="sidebar-item-text sidebar-link">Storing Multiple Values in Collections</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_lesson/15-tidying.html" class="sidebar-item-text sidebar-link">Tidying up the Analysis</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_lesson/02-variables.html" class="sidebar-item-text sidebar-link">Types, Objects, Values and Variables</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_lesson/08-libraries.html" class="sidebar-item-text sidebar-link">Using External Modules</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_lesson/05-scripts.html" class="sidebar-item-text sidebar-link">Writing Python Scripts</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#visualizing-data" id="toc-visualizing-data" class="nav-link active" data-scroll-target="#visualizing-data">Visualizing data</a>
  <ul class="collapse">
  <li><a href="#grouping-plots" id="toc-grouping-plots" class="nav-link" data-scroll-target="#grouping-plots">Grouping plots</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Producing Plots</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><strong>The code <code>pd_episode12_plotting.ipynb</code> for this episode can be downloaded from <a href="https://osf.io/wgjba/download">here</a></strong></p>
<section id="visualizing-data" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-data">Visualizing data</h2>
<p>The mathematician Richard Hamming once said, “The purpose of computing is insight, not numbers,” and the best way to develop insight is often to visualize data. Visualization deserves an entire lecture of its own, but we can explore a few features of Python’s <code>matplotlib</code> library here. While there is no official plotting library, <code>matplotlib</code> is the <em>de facto</em> the standard. First, we will import the <code>pyplot</code> module from <code>matplotlib</code> and use two of its functions to create and display a heat map of our data:</p>
<pre><code>import matplotlib.pyplot
image = matplotlib.pyplot.imshow(data)
matplotlib.pyplot.show()</code></pre>
<p>{: .language-python}</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/01-numpy_71_0.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Heatmap of the Data</figcaption><p></p>
</figure>
</div>
<p>Blue pixels in this heat map represent low values, while yellow pixels represent high values. As we can see, inflammation rises and falls over a 40-day period.</p>
<p>Let’s take a look at the average inflammation over time:</p>
<pre><code>ave_inflammation = numpy.mean(data, axis=0)
ave_plot = matplotlib.pyplot.plot(ave_inflammation)
matplotlib.pyplot.show()</code></pre>
<p>{: .language-python}</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/01-numpy_73_0.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Average Inflammation Over Time</figcaption><p></p>
</figure>
</div>
<p>Here, we have put the average per day across all patients in the variable <code>ave_inflammation</code>, then asked <code>matplotlib.pyplot</code> to create and display a line graph of those values. The result is a roughly linear rise and fall, which is suspicious: we might instead expect a sharper rise and slower fall. Let’s have a look at two other statistics:</p>
<pre><code>max_plot = matplotlib.pyplot.plot(numpy.max(data, axis=0))
matplotlib.pyplot.show()</code></pre>
<p>{: .language-python}</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/01-numpy_75_1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Maximum Value Along The First Axis</figcaption><p></p>
</figure>
</div>
<pre><code>min_plot = matplotlib.pyplot.plot(numpy.min(data, axis=0))
matplotlib.pyplot.show()</code></pre>
<p>{: .language-python}</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/01-numpy_75_3.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Minimum Value Along The First Axis</figcaption><p></p>
</figure>
</div>
<p>The maximum value rises and falls smoothly, while the minimum seems to be a step function. Neither trend seems particularly likely, so either there’s a mistake in our calculations or something is wrong with our data. This insight would have been difficult to reach by examining the numbers themselves without visualization tools.</p>
<section id="grouping-plots" class="level3">
<h3 class="anchored">Grouping plots</h3>
<p>You can group similar plots in a single figure using subplots. This script below uses a number of new commands. The function <code>matplotlib.pyplot.figure()</code> creates a space into which we will place all of our plots. The parameter <code>figsize</code> tells Python how big to make this space. Each subplot is placed into the figure using its <code>add_subplot</code> <a href="{{ page.root }}/reference/#method">method</a>. The <code>add_subplot</code> method takes 3 parameters. The first denotes how many total rows of subplots there are, the second parameter refers to the total number of subplot columns, and the final parameter denotes which subplot your variable is referencing (left-to-right, top-to-bottom). Each subplot is stored in a different variable (<code>axes1</code>, <code>axes2</code>, <code>axes3</code>). Once a subplot is created, the axes can be titled using the <code>set_xlabel()</code> command (or <code>set_ylabel()</code>). Here are our three plots side by side:</p>
<pre><code>import numpy
import matplotlib.pyplot

data = numpy.loadtxt(fname='inflammation-01.csv', delimiter=',')

fig = matplotlib.pyplot.figure(figsize=(10.0, 3.0))

axes1 = fig.add_subplot(1, 3, 1)
axes2 = fig.add_subplot(1, 3, 2)
axes3 = fig.add_subplot(1, 3, 3)

axes1.set_ylabel('average')
axes1.plot(numpy.mean(data, axis=0))

axes2.set_ylabel('max')
axes2.plot(numpy.max(data, axis=0))

axes3.set_ylabel('min')
axes3.plot(numpy.min(data, axis=0))

fig.tight_layout()

matplotlib.pyplot.show()</code></pre>
<p>{: .language-python}</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../fig/01-numpy_80_0.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">The Previous Plots as Subplots</figcaption><p></p>
</figure>
</div>
<p>The <a href="{{ page.root }}/reference/#function-call">call</a> to <code>loadtxt</code> reads our data, and the rest of the program tells the plotting library how large we want the figure to be, that we’re creating three subplots, what to draw for each one, and that we want a tight layout. (If we leave out that call to <code>fig.tight_layout()</code>, the graphs will actually be squeezed together more closely.)</p>
<blockquote class="blockquote">
<h2 id="back-to-scripts" class="anchored" data-anchor-id="grouping-plots">Back to Scripts</h2>
<p>When you start producing more complicated plots like this, we recommend switching back to writing scripts so you can store how to make your plots! {: .callout}</p>
</blockquote>
<blockquote class="blockquote">
<h2 id="scientists-dislike-typing" class="anchored">Scientists Dislike Typing</h2>
<p>We will always use the syntax <code>import numpy</code> to import NumPy. However, in order to save typing, it is <a href="http://www.scipy.org/getting-started.html#an-example-script">often suggested</a> to make a shortcut like so: <code>import numpy as np</code>. If you ever see Python code online using a NumPy function with <code>np</code> (for example, <code>np.loadtxt(...)</code>), it’s because they’ve used this shortcut. When working with other people, it is important to agree on a convention of how common libraries are imported. {: .callout}</p>
</blockquote>
<blockquote class="blockquote">
<h2 id="plot-scaling" class="anchored">Plot Scaling</h2>
<p>Why do all of our plots go right up to the top of the y axis?</p>
<blockquote class="blockquote">
<h2 id="solution" class="anchored">Solution</h2>
<p>Because matplotlib normally sets x and y axes limits to the min and max of our data (depending on data range) {: .solution}</p>
</blockquote>
<p>If we want to change this, we can use the <code>set_ylim(min, max)</code> method of each ‘axes’, for example:</p>
<pre><code>axes3.set_ylim(0,6)</code></pre>
<p>{: .language-python}</p>
<p>Update your plotting code to automatically set a more appropriate scale. (Hint: you can make use of the <code>max</code> and <code>min</code> methods to help.)</p>
<blockquote class="blockquote">
<h2 id="solution-1" class="anchored">Solution</h2>
<pre><code># One method
axes3.set_ylabel('min')
axes3.plot(numpy.min(data, axis=0))
axes3.set_ylim(0,6)</code></pre>
<p>{: .language-python} {: .solution}</p>
</blockquote>
<blockquote class="blockquote">
<h2 id="solution-2" class="anchored">Solution</h2>
<pre><code># A more automated approach
min_data = numpy.min(data, axis=0)
axes3.set_ylabel('min')
axes3.plot(min_data)
axes3.set_ylim(numpy.min(min_data), numpy.max(min_data) * 1.1)</code></pre>
<p>{: .language-python} {: .solution} {: .challenge}</p>
</blockquote>
</blockquote>
<blockquote class="blockquote">
<h2 id="drawing-straight-lines" class="anchored">Drawing Straight Lines</h2>
<p>In the center and right subplots above, we expect all lines to look like step functions because non-integer value are not realistic for the minimum and maximum values. However, you can see that the lines are not always vertical or horizontal, and in particular the step function in the subplot on the right looks slanted. Why is this?</p>
<blockquote class="blockquote">
<h2 id="solution-3" class="anchored">Solution</h2>
<p>Because matplotlib interpolates (draws a straight line) between the points. One way to do avoid this is to use the Matplotlib <code>drawstyle</code> option:</p>
<pre><code>import numpy
import matplotlib.pyplot

data = numpy.loadtxt(fname='inflammation-01.csv', delimiter=',')

fig = matplotlib.pyplot.figure(figsize=(10.0, 3.0))

axes1 = fig.add_subplot(1, 3, 1)
axes2 = fig.add_subplot(1, 3, 2)
axes3 = fig.add_subplot(1, 3, 3)

axes1.set_ylabel('average')
axes1.plot(numpy.mean(data, axis=0), drawstyle='steps-mid')

axes2.set_ylabel('max')
axes2.plot(numpy.max(data, axis=0), drawstyle='steps-mid')

axes3.set_ylabel('min')
axes3.plot(numpy.min(data, axis=0), drawstyle='steps-mid')

fig.tight_layout()

matplotlib.pyplot.show()</code></pre>
<p>{: .language-python} <img src="../fig/01-numpy_exercise_0.png" class="img-fluid" alt="Plot with step lines"> {: .solution} {: .challenge}</p>
</blockquote>
</blockquote>
<blockquote class="blockquote">
<h2 id="make-your-own-plot" class="anchored">Make Your Own Plot</h2>
<p>Create a plot showing the standard deviation (<code>numpy.std</code>) of the inflammation data for each day across all patients.</p>
<blockquote class="blockquote">
<h2 id="solution-4" class="anchored">Solution</h2>
<pre><code>std_plot = matplotlib.pyplot.plot(numpy.std(data, axis=0))
matplotlib.pyplot.show()</code></pre>
<p>{: .language-python} {: .solution} {: .challenge}</p>
</blockquote>
</blockquote>
<blockquote class="blockquote">
<h2 id="moving-plots-around" class="anchored">Moving Plots Around</h2>
<p>Modify the program to display the three plots on top of one another instead of side by side.</p>
<blockquote class="blockquote">
<h2 id="solution-5" class="anchored">Solution</h2>
<pre><code>import numpy
import matplotlib.pyplot

data = numpy.loadtxt(fname='inflammation-01.csv', delimiter=',')

# change figsize (swap width and height)
fig = matplotlib.pyplot.figure(figsize=(3.0, 10.0))

# change add_subplot (swap first two parameters)
axes1 = fig.add_subplot(3, 1, 1)
axes2 = fig.add_subplot(3, 1, 2)
axes3 = fig.add_subplot(3, 1, 3)

axes1.set_ylabel('average')
axes1.plot(numpy.mean(data, axis=0))

axes2.set_ylabel('max')
axes2.plot(numpy.max(data, axis=0))

axes3.set_ylabel('min')
axes3.plot(numpy.min(data, axis=0))

fig.tight_layout()

matplotlib.pyplot.show()</code></pre>
<p>{: .language-python} {: .solution} {: .challenge}</p>
</blockquote>
</blockquote>
<p>{% include links.md %}</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>